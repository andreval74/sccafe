<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compra Direta TKN - SCCAFE</title>

<!-- Favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="imgs/sccafe-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="imgs/sccafe-32x32.png">

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<!-- SCCAFE Global CSS Unificado -->
<link href="styles/globals.css" rel="stylesheet">

<!-- Ethers.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
</head>
<body>
<!-- Header -->
<header data-component="header"></header>

<!-- Main Content -->
<main class="token-creator-main py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-xl-10 col-lg-11">
        <div class="creator-card bg-dark border border-primary rounded-4 p-4 shadow-lg">
          
          <!-- Header -->
          <div class="creator-header border-bottom border-secondary pb-4 mb-4">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h1 class="display-6 fw-bold text-white mb-2">
                  <i class="bi bi-cart-plus text-primary me-2"></i>Compra Direta TKN
                </h1>
                <p class="text-secondary mb-0">Adquira tokens TKN usando BNB na BSC Testnet</p>
              </div>
              <div class="d-none d-md-block">
                <img src="imgs/sccafe.png" alt="SCCAFE" style="height: 60px;">
              </div>
            </div>
          </div>

          <!-- Se√ß√£o 1: Teste de Conex√£o -->
          <div class="card bg-dark border-warning shadow mb-4">
            <div class="card-header bg-warning text-dark">
              <h5 class="card-title mb-0">
                <i class="bi bi-wifi me-2"></i>1. Teste de Conex√£o MetaMask
              </h5>
            </div>
            <div class="card-body">
              <p class="text-secondary mb-3">Primeiro, vamos verificar se sua carteira est√° funcionando</p>
              <div class="row g-3">
                <div class="col-md-8">
                  <p id="status" class="mb-2 text-white">Clique em "Testar Conex√£o" para verificar</p>
                </div>
                <div class="col-md-4">
                  <button id="testConnection" class="btn btn-warning w-100 fw-bold">
                    <i class="bi bi-wifi me-2"></i>TESTAR CONEX√ÉO
                  </button>
                </div>
              </div>
              <!-- Resultado do teste -->
              <div id="connectionResult" class="mt-3" style="display: none;">
                <div class="alert alert-info mb-0">
                  <ul id="connectionErrors" class="mb-0"></ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Se√ß√£o 2: Verifica√ß√£o do Contrato -->
          <div class="card bg-dark border-info shadow mb-4">
            <div class="card-header bg-info text-dark">
              <h5 class="card-title mb-0">
                <i class="bi bi-search me-2"></i>2. Verifica√ß√£o do Contrato
              </h5>
            </div>
            <div class="card-body">
              <p class="text-secondary mb-3">Verificar informa√ß√µes do token e disponibilidade</p>
              <div class="row g-3 mb-3">
                <div class="col-md-6">
                  <small class="text-muted">Nome do Token</small>
                  <p id="tokenName" class="fw-bold mb-2">Clique em verificar</p>
                </div>
                <div class="col-md-6">
                  <small class="text-muted">S√≠mbolo</small>
                  <p id="tokenSymbol" class="fw-bold mb-2">-</p>
                </div>
                <div class="col-md-6">
                  <small class="text-muted">Pre√ßo por Token</small>
                  <p id="tokenPriceDisplay" class="fw-bold text-primary mb-2">0.003 BNB</p>
                </div>
                <div class="col-md-6">
                  <small class="text-muted">Dispon√≠vel para Compra</small>
                  <p id="tokenBalance" class="fw-bold text-success mb-2">-</p>
                </div>
              </div>
              <button id="checkContract" class="btn btn-info fw-bold">
                <i class="bi bi-search me-2"></i>VERIFICAR CONTRATO
              </button>
              <!-- Resultado da verifica√ß√£o -->
              <div id="contractResult" class="mt-3" style="display: none;">
                <div class="alert alert-success mb-0">
                  <ul id="contractErrors" class="mb-0"></ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Se√ß√£o 3: Calculadora e Compra -->
          <div class="card bg-dark border-success shadow mb-4">
            <div class="card-header bg-success text-dark">
              <h5 class="card-title mb-0">
                <i class="bi bi-calculator me-2"></i>3. Calculadora e Compra
              </h5>
            </div>
            <div class="card-body">
              <p class="text-secondary mb-3">Digite a quantidade e realize a compra</p>
              <div class="row g-3 mb-3">
                <div class="col-md-8">
                  <label for="tokenAmount" class="form-label text-white">Quantidade de Tokens</label>
                  <input type="number" id="tokenAmount" class="form-control bg-dark text-white border-secondary" 
                         placeholder="Ex: 100" min="1">
                </div>
                <div class="col-md-4 d-flex align-items-end">
                  <button id="buyButton" class="btn btn-success w-100 btn-lg fw-bold">
                    <i class="bi bi-cart-check me-2"></i>COMPRAR
                  </button>
                </div>
              </div>
              
              <!-- Calculadora (aparece quando digita) -->
              <div id="calculationDisplay" class="alert alert-primary" style="display: none;">
                <h6 class="text-dark mb-2">üí∞ C√°lculo da Compra</h6>
                <div class="row g-2">
                  <div class="col-md-4">
                    <small class="text-dark">Quantidade</small>
                    <p id="calcTokens" class="fw-bold text-dark mb-1">0</p>
                  </div>
                  <div class="col-md-4">
                    <small class="text-dark">Total a Pagar</small>
                    <p id="calcTotal" class="fw-bold text-dark mb-1">0 BNB</p>
                  </div>
                  <div class="col-md-4">
                    <small class="text-dark">Status</small>
                    <p id="availabilityStatus" class="fw-bold mb-1">-</p>
                  </div>
                </div>
              </div>
              
              <!-- Resultado da compra -->
              <div id="purchaseResult" class="mt-3" style="display: none;">
                <div class="alert alert-warning mb-0">
                  <ul id="purchaseErrors" class="mb-0"></ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Se√ß√£o 4: Detalhes da Transa√ß√£o -->
          <div class="card bg-dark border-primary shadow mb-4" id="transactionDetails" style="display: none;">
            <div class="card-header bg-primary text-dark">
              <h5 class="card-title mb-0">
                <i class="bi bi-receipt me-2"></i>4. Detalhes da Transa√ß√£o
              </h5>
            </div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-6">
                  <small class="text-muted">Hash da Transa√ß√£o</small>
                  <p id="txHash" class="fw-bold font-monospace small text-break text-primary">-</p>
                </div>
                <div class="col-md-6">
                  <small class="text-muted">Tokens Recebidos</small>
                  <p id="txTokensReceived" class="fw-bold text-success">-</p>
                </div>
                <div class="col-md-4">
                  <small class="text-muted">Valor Enviado</small>
                  <p id="txValue" class="fw-bold text-white">- BNB</p>
                </div>
                <div class="col-md-4">
                  <small class="text-muted">Taxa de Gas</small>
                  <p id="txGasPrice" class="fw-bold text-white">- BNB</p>
                </div>
                <div class="col-md-4">
                  <small class="text-muted">Total Pago</small>
                  <p id="txTotalCost" class="fw-bold text-warning">- BNB</p>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</main>

<!-- Footer -->
<footer data-component="footer"></footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- SCCAFE Shared Modules (carregados antes do m√≥dulo espec√≠fico) -->
<script src="js/shared/metamask-connector.js"></script>
<script src="js/shared/common-utils.js"></script>
<script src="js/shared/token-global.js"></script>

<!-- Template Loader -->
<script src="js/template-loader.js"></script>

<!-- M√≥dulo de Compra de Tokens -->
<script src="js/compra-token.js"></script>

</body>
</html>
